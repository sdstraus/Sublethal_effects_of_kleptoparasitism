geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
theme(text = element_text(size=20))+
ylab("BCI difference")
library(viridis)
viridis_pal(4)
anova(lm(diff.resids ~ Treatment, data = all.col)) # p=0.06
RColorBrewer::brewer.pal(n=2, name = "Dark2")
my_pal <- RColorBrewer::brewer.pal(n=3, name = "Dark2")
my_pal
ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,
fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal)))+
theme(text = element_text(size=20))+
ylab("BCI difference")
## hex codes for viridis colours
scales::show_col(viridis_pal()(4))
scales::show_col(viridis_pal()24))
scales::show_col(viridis_pal()(1))
scales::show_col(viridis_pal("A")(4))
?viridis_pal
scales::show_col(viridis_pal(option = "A")(4))
scales::show_col(viridis_pal(option = "B")(4))
scales::show_col(viridis_pal(option = "C")(4))
?viridis
viridis(option = "C", n = 4)
viridis(option = "C", n = 3)
scales::show_col(viridis_pal(option = "C")(3))
scales::show_col(viridis_pal(option = "C")(4))
viridis(option = "C", n = 4)
my_pal <- viridis(option = "C", n = 4)
ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,
fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[1:3])))+
theme(text = element_text(size=20))+
ylab("BCI difference")
my_pal <- my_pal[c(4,3,2,1)]
ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,
fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[1:3])))+
theme(text = element_text(size=20))+
ylab("BCI difference")
ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,
fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab("BCI difference")
df_new <- rbind(adults, sub2, sub1.final)
y <- lm(log(weight.mg) ~ log(CT.W), data = df_new)
df_new$resids <- residuals(y)
# order instar
df_new$instar <- factor(df_new$instar, order = TRUE, levels = c("Sub 1", "Sub 2", "Adult"))
# mega model
full.mod <- lmer(resids ~ Treatment + Measurement + Treatment:Measurement + (1|instar) + (1|Nest), data = df_new)
Anova(full.mod, test.statistic = "F")
summary(full.mod)
ggplot(full.mod, aes(x = Treatment, y = resids, color = Measurement, fill = instar))+
geom_boxplot()+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
theme(text = element_text(size=20))+
ylab("Body Condition Index")
ggplot(df_new, aes(x = Treatment, y = resids, color = Measurement, fill = instar))+
geom_boxplot()+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
theme(text = element_text(size=20))+
ylab("Body Condition Index")
df.after <- df_all[c(which(df_all$Measurement == "after")),]
y2 <- lmer(resids ~ Treatment + (1|Nest), data = df.after)
View(df.after)
df.new <- df_all[c(which(df_all$Measurement == "after")),]
y2 <- lmer(resids ~ Treatment + (1|Nest), data = df.after)
df.after <- df_new[c(which(df_all$Measurement == "after")),]
y2 <- lmer(resids ~ Treatment + (1|Nest), data = df.after)
Anova(y2)
View(df_new)
df.after <- df_new[c(which(df_new$Measurement == "after")),]
y2 <- lmer(resids ~ Treatment + (1|Nest), data = df.after)
Anova(y2)
anova(lm(diff.resids ~ instar + Treatment, data = all.col)) # p=0.06
############ Mortality ##########
col.counts <- read.csv("../data/colony_counts.csv")
# remove Col_21 : Note says "Escapees"
col.counts <- col.counts %>% filter(Colony != "Col_21")
View(col.counts)
col.counts$num.all <- col.counts$num.adult + col.counts$num.sub2 + col.counts$num.sub1
num.after <- col.counts[c(which(col.counts$Measurement == "After")),]
num.after[,7] <- NULL
x <- lm(num.adult ~ Treatment, data =num.after)
x.2 <- glm(num.adult ~ Treatment, data =num.after, family = poisson(link = "identity"))
AIC(x, x.2)
Anova(x.2)
plot(num.adult ~ Treatment, num.after, ylab = "Number Adults", cex.axis = 1.5, cex.lab = 1.5)
cohen.d(num.after$num.adult, num.after$Treatment)
effsize::cohen.d(num.after$num.adult, num.after$Treatment)
y <- lm(num.sub2 ~ Treatment, data = num.after)
y.2 <- glm(num.sub2 ~ Treatment, data = num.after, family = poisson(link = "identity"))
AIC(y, y.2)
Anova(y.2)
plot(num.sub2 ~ Treatment, num.after, ylab = "Number Sub 2", cex.axis = 1.5, cex.lab = 1.5)  #...higher?
plot(num.sub2 ~ Treatment, num.after, ylab = "Number Sub 2")  #...higher?
View(num.after)
z <- glm(num.sub1 ~ Treatment, data =  num.after, family = poisson(link = "identity"))
Anova(z)
cohen.d(num.after$num.sub1, num.after$Treatment)
effsize::cohen.d(num.after$num.sub1, num.after$Treatment)
w <- glm(num.all ~ Treatment, data = num.after, family = poisson(link = "identity"))
Anova(w)
effsize::cohen.d(num.after$num.all, num.after$Treatment)
# make num.after long format
num.long <- num.after %>%
pivot_longer(!c(Colony, Treatment, Measurement), names_to = "instar", values_to = "count")
num.long <- num.long %>% mutate(instar = recode_factor(instar, num.sub1  = "Sub 1", num.sub2 = "Sub 2", num.adult = "Adult"))
num.long$instar <- factor(num.long$instar, order = TRUE, levels = c("Sub 1", "Sub 2", "Adult"))
ggplot(data = filter(num.long, instar != "num.all"), aes(x = count, group = instar, fill = instar)) +
geom_density(alpha = 0.5)+
xlab("Count")+
theme_cowplot()
hist(num.after$num.adult)
hist(num.after$num.sub1)
hist(num.after$num.sub2)
num.long <-  num.long %>% filter(instar != "num.all")
instar.count <- glm(count ~ instar, data = num.long, family = poisson(link = "identity"))
Anova(instar.count)
summary(instar.count)
mod.av <- aov(instar.count)
TUKEY <- TukeyHSD(x=mod.av)
sig.letters <- TUKEY$instar[order(row.names(TUKEY$instar)), ]
value_max = num.long %>% group_by(instar) %>% summarize(max_value = max(count))
ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar)) +
geom_boxplot(alpha = 0.5)+
geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
theme_cowplot()+
stat_summary(fun=mean, geom="point", size=2, color="red")+
theme(legend.position = "none")
View(num.long)
instar.count <- glm(count ~ instar + Treatment, data = num.long, family = poisson(link = "identity"))
Anova(instar.count)
instar.count <- glm(count ~ instar + Treatment + instar:Treatment, data = num.long, family = poisson(link = "identity"))
Anova(instar.count)
ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar, color = Treatment)) +
geom_boxplot(alpha = 0.5)+
# geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
theme_cowplot()+
stat_summary(fun=mean, geom="point", size=2, color="red")+
theme(legend.position = "none")
# only looking at after
avg_BCI_after <- df_new %>% filter(Measurement == "after") %>%
group_by(Nest) %>%
summarise(BCI = mean(resids))
ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar, color = Treatment)) +
geom_boxplot(alpha = 0.5)+
# geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
scale_color_manual(values = c("black", "grey"))+
theme_cowplot()+
stat_summary(fun=mean, geom="point", size=2, color="red")
ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar, color = Treatment)) +
geom_boxplot(alpha = 0.5)+
# geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
scale_color_manual(values = c("black", "grey"))+
theme_cowplot()
x.2 <- glm(num.adult ~ Treatment, data =num.after, family = poisson(link = "identity"))
Anova(x.2)
y.2 <- glm(num.sub2 ~ Treatment, data = num.after, family = poisson(link = "identity"))
Anova(y.2)
z <- glm(num.sub1 ~ Treatment, data =  num.after, family = poisson(link = "identity"))
Anova(z)
ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab("BCI difference")
ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab("BCI difference")+
xlab("Instar")
?legend
ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab("BCI difference")+
xlab("Instar")
ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab("BCI difference")+
xlab("Instar")+
labs(color = "Instar")
ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab("BCI difference")+
xlab("Instar")+
labs(color = "Treatment", fill = "Instar")
diff.plot <- ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab("BCI difference")+
xlab("Instar")+
labs(color = "Treatment", fill = "Instar")
getwd()
setwd("Users/sam/github/FitnessEffects/")
setwd("Users/sam/github/FitnessEffects")
setwd("/Users/sam/github/FitnessEffects")
ggsave(diff.plot, filename = "figures/diff_plot.jpeg", dpi = "retina", width = 5, height = 5, units = "in")
ggsave(diff.plot, filename = "figures/diff_plot.jpeg", dpi = "retina", width = 5, height = 4, units = "in")
ggsave(diff.plot, filename = "figures/diff_plot.jpeg", dpi = "retina", width = 5, height = 3, units = "in")
my_pal <- viridis(option = "C", n = 4)
my_pal <- my_pal[c(4,3,2,1)]
ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar, color = Treatment)) +
geom_boxplot(alpha = 0.5)+
# geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
scale_color_manual(values = c("black", "grey"))+
scale_fill_manuaL(value = paste(my_pal[2:4]))+
theme_cowplot()
ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar, color = Treatment)) +
geom_boxplot(alpha = 0.5)+
# geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
scale_color_manual(values = c("black", "grey"))+
scale_fill_manual(value = paste(my_pal[2:4]))+
theme_cowplot()
ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar, color = Treatment)) +
geom_boxplot(alpha = 0.5)+
# geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
scale_color_manual(values = c("black", "grey"))+
scale_fill_manual(values = paste(my_pal[2:4]))+
theme_cowplot()
ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar, color = Treatment)) +
geom_boxplot(alpha = 0.7)+
# geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
scale_color_manual(values = c("black", "grey"))+
scale_fill_manual(values = paste(my_pal[2:4]))+
theme_cowplot()
ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar, color = Treatment)) +
geom_boxplot(alpha = 0.7)+
# geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
scale_color_manual(values = c("black", "grey"))+
scale_fill_manual(values = paste(my_pal[2:4]))+
theme_cowplot()+
labs(fill = "Instar")
ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar, color = Treatment)) +
geom_boxplot(alpha = 0.7)+
# geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
scale_color_manual(values = c("black", "grey"))+
scale_fill_manual(values = paste(my_pal[2:4]))+
theme_cowplot()+
labs(fill = "Instar", y = "Final count")
final.count <- ggplot(data = filter(num.long, instar != "num.all"), aes(x = instar, y = count, fill = instar, color = Treatment)) +
geom_boxplot(alpha = 0.7)+
# geom_text(data = value_max, aes(x = instar, y = max_value + 1, label = c("a", "ab", "b")) ,vjust=0)+
xlab("Instar")+
scale_color_manual(values = c("black", "grey"))+
scale_fill_manual(values = paste(my_pal[2:4]))+
theme_cowplot()+
labs(fill = "Instar", y = "Final count")
ggsave(final.count, filename = "figures/count_plot.jpeg", dpi = "retina", width = 5, height = 3, units = "in")
ggsave(final.count, filename = "figures/count_plot.jpeg", dpi = "retina", width = 10, height = 6, units = "in")
ggsave(final.count, filename = "figures/count_plot.jpeg", dpi = "retina", width = 7.5, height = 4.5, units = "in")
ggsave(diff.plot, filename = "figures/diff_plot.jpeg", dpi = "retina", width = 10, height = 8, units = "in")
ggsave(diff.plot, filename = "figures/diff_plot.jpeg", dpi = "retina", width = 10, height = 6, units = "in")
ggsave(diff.plot, filename = "figures/diff_plot.jpeg", dpi = "retina", width = 10, height = 5.5, units = "in")
# parasites, sub2, comparing before and after
sub1.parasite <- sub1.final %>%
filter(Treatment == "Parasite")
cohen.d(sub1.parasite$resids, sub1.parasite$Measurement)
effsize::cohen.d(sub1.parasite$resids, sub1.parasite$Measurement)
slope <- 2.263
intercept <- -0.761
10^(intercept + (slope * 5))
intercept + (slope * 5)
log10(intercept) + (5*log10(slope))
10^intercept
10^intercept + (5 * 10^slope)
10^intercept + (5 * (10^slope))
exp(intercept)
exp()
exp(1)
10^slope
10^(intercept + (slope*log10(5)))
6.62 * 10
10^-2.5
10^-2.5 * 45 * 24
10^0.5
log10(10)
log10(50)
10^2
10^1.5
10^0.3
10^-2.5
(10^-2.5) * 24
(10^-2.5) * 24 * 45
10^0.5
10^(intercept + (slope*log10(5)))
intercept <- -1.355
slope <- 2.4
10^(intercept + (slope*log10(5)))
10^-2.5
10^-2.4
10^-2.5
(10^-2.5) * 24 * 45
(10^-2.1) * 24 * 45
10^(intercept + (slope*log10(5)))
10^(intercept + (slope*log10(5))) * 5
10^(intercept + (slope*log10(3))) * 5
10^(intercept + (slope*log10(4))) * 5
10^(intercept + (slope*log10(4)))
anova(lm(diff.resids ~ instar + Treatment+instar:Treatment, data = all.col)) # p=0.06
summary(lm(diff.resids ~ instar + Treatment, data = all.col))
anova(lm(diff.resids ~ instar + Treatment+instar:Treatment, data = all.col)) # p=0.06
summary(lm(diff.resids ~ instar + Treatment, data = all.col))
ggplot(data=adults, aes(x=CT.W, y = weight.mg))+
geom_point()+
geom_smooth(method = "lm")+
xlab("Cephalothorax Width (mm)")+
ylab("Spider Weight (mg)")+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
theme_classic()+
theme(axis.text = element_text(size = 20, color = "black"),
axis.title = element_text(size = 20),
axis.line = element_line(size = 1.1))
adult.resid.plot <- ggplot(data=adults, aes(x=CT.W, y = weight.mg))+
geom_point()+
geom_smooth(method = "lm")+
xlab("Cephalothorax Width (mm)")+
ylab("Spider Weight (mg)")+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
theme_classic()+
theme(axis.text = element_text(size = 20, color = "black"),
axis.title = element_text(size = 20),
axis.line = element_line(size = 1.1))
sub2.resid.plot <- ggplot(data=sub2, aes(x=CT.W, y = weight.mg))+
geom_point()+
geom_smooth(method = "lm")+
xlab("Cephalothorax Width (mm)")+
ylab("Spider Weight (mg)")+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
theme_classic()+
theme(axis.text = element_text(size = 20, color = "black"),
axis.title = element_text(size = 20),
axis.line = element_line(size = 1.1))
sub1.resid.plot <- ggplot(data=sub1.final, aes(x=CT.W, y = weight.mg))+
geom_point()+
geom_smooth(method = "lm")+
xlab("Cephalothorax Width (mm)")+
ylab("Spider Weight (mg)")+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
theme_classic()+
theme(axis.text = element_text(size = 20, color = "black"),
axis.title = element_text(size = 20),
axis.line = element_line(size = 1.1))
resid.plots <- ggarrange(adult.resid.plot, sub2.resid.plot, sub1.resid.plot, labels = "auto")
ggsave(resid.plots, filename = "/figures/resid.plots.jpeg", retine = "dpi",
width = 10, height = 3, units = "in")
ggsave(resid.plots, filename = "/figures/resid.plots.jpeg", dpi = "retina",
width = 10, height = 3, units = "in")
getwd()
ggsave(resid.plots, filename = "/figures/resid.plots.jpeg", dpi = "retina",
width = 10, height = 3, units = "in")
resid.plots
resid.plots
resid.plots <- ggarrange(adult.resid.plot, sub2.resid.plot, sub1.resid.plot, labels = "auto", rows = 1)
?ggarrange
resid.plots <- ggarrange(adult.resid.plot, sub2.resid.plot, sub1.resid.plot, labels = "auto", nrow = 1)
ggsave(resid.plots, filename = "/figures/resid.plots.jpeg", dpi = "retina",
width = 10, height = 3, units = "in")
ggsave(resid.plots, filename = "figures/resid.plots.jpeg", dpi = "retina",
width = 10, height = 3, units = "in")
adult.resid.plot <- ggplot(data=adults, aes(x=CT.W, y = weight.mg))+
geom_point()+
geom_smooth(method = "lm")+
xlab("Cephalothorax Width (mm)")+
ylab("Spider Weight (mg)")+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
theme_classic()+
theme(axis.text = element_text(size = 16, color = "black"),
axis.title = element_text(size = 16),
axis.line = element_line(size = 1.0))
sub2.resid.plot <- ggplot(data=sub2, aes(x=CT.W, y = weight.mg))+
geom_point()+
geom_smooth(method = "lm")+
xlab("Cephalothorax Width (mm)")+
ylab("Spider Weight (mg)")+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
theme_classic()+
theme(axis.text = element_text(size = 16, color = "black"),
axis.title = element_text(size = 16),
axis.line = element_line(size = 1.0))
sub1.resid.plot <- ggplot(data=sub1.final, aes(x=CT.W, y = weight.mg))+
geom_point()+
geom_smooth(method = "lm")+
xlab("Cephalothorax Width (mm)")+
ylab("Spider Weight (mg)")+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
theme_classic()+
theme(axis.text = element_text(size = 16, color = "black"),
axis.title = element_text(size = 16),
axis.line = element_line(size = 1.0))
resid.plots <- ggarrange(adult.resid.plot, sub2.resid.plot, sub1.resid.plot, labels = "auto", nrow = 1)
ggsave(resid.plots, filename = "figures/resid.plots.jpeg", dpi = "retina",
width = 10, height = 3, units = "in")
ggsave(resid.plots, filename = "figures/resid.plots.jpeg", dpi = "retina",
width = 12, height = 4, units = "in")
diff.plot <- ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab(expression(paste(delta~"BCI")))+
xlab("Instar")+
labs(color = "Treatment", fill = "Instar")
diff.plot
diff.plot <- ggplot(data = all.col, aes(x = instar, y = diff.resids, color = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_color_manual(values = c("black", "darkgrey"))+
scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab(expression(paste(Delta~"BCI")))+
xlab("Instar")+
labs(color = "Treatment", fill = "Instar")
diff.plot
ggsave(diff.plot, filename = "figures/diff_plot.jpeg", dpi = "retina", width = 10, height = 5.5, units = "in")
