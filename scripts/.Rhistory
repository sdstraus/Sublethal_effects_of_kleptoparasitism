geom_point()+
geom_smooth(method = "lm")+
xlab("Cephalothorax Width (mm)")+
ylab("Spider Weight (mg)")+
scale_x_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
theme_classic()+
theme(axis.text = element_text(size = 16, color = "black"),
axis.title = element_text(size = 16),
axis.line = element_line(size = 1.0))
resid.plots <- ggarrange(adult.resid.plot, sub2.resid.plot, sub1.resid.plot, labels = "auto", nrow = 1)
ggsave(resid.plots, filename = "figures/resid.plots.jpeg", dpi = "retina",
width = 12, height = 4, units = "in")
#### sub 1 effect sizes ####
# sub1, before comparing treatments
sub1.before <- sub1.final %>%
filter(Measurement == "before")
y1 <- lmer(resids ~ Treatment + (1|Nest), data = sub1.before)
Anova(y1, test.statistic = "F")
sub1.p0 <- ggplot(data = sub1.before, aes(x = resids, group = Treatment, fill = Treatment)) +
geom_density(alpha = 0.5)+
xlab("Body Condition Index")+
theme_cowplot()
cohen.d(sub1.before$resids, sub1.before$Treatment)
# sub1, after comparing treatments
sub1.after <- sub1.final %>%
filter(Measurement == "after")
cohen.d(sub1.after$resids, sub1.after$Treatment)
y2 <- lmer(resids ~ Treatment + (1|Nest), data = sub1.after)
Anova(y2, test.statistic = "F")
sub1.p1 <- ggplot(data = sub1.after, aes(x = resids, group = Treatment, fill = Treatment)) +
geom_density(alpha = 0.5)+
xlab("Body Condition Index")+
theme_cowplot()
# sub1, control, comparing before and after
sub1.control <- sub1.final %>%
filter(Treatment == "Control")
cohen.d(sub1.control$resids, sub1.control$Measurement)
y3 <- lmer(resids ~ Measurement + (1|Nest), data = sub1.control)
Anova(y3, test.statistic = "F")
sub1.p2 <- ggplot(data = sub1.control, aes(x = resids, group = Measurement, fill = Measurement)) +
geom_density(alpha = 0.5)+
xlab("Body Condition Index")+
theme_cowplot()
# parasites, sub2, comparing before and after
sub1.parasite <- sub1.final %>%
filter(Treatment == "Parasite")
effsize::cohen.d(sub1.parasite$resids, sub1.parasite$Measurement)
y4 <- lmer(resids ~ Measurement + (1|Nest), data = sub1.parasite)
Anova(y4, test.statistic = "F")
sub1.p3 <- ggplot(data = sub1.parasite, aes(x = resids, group = Measurement, fill = Measurement)) +
geom_density(alpha = 0.5)+
xlab("Body Condition Index")+
theme_cowplot()
s1.bf.col <- sub1.before %>%
group_by(Nest, Treatment) %>%
summarize(before.res = mean(resids))
s1.af.col <- sub1.after %>%
group_by(Nest, Treatment) %>%
summarize(s1.after.res = mean(resids)) %>%
mutate(instar = "Sub1")
write.csv(s1.af.col, "../data/sub1_bcis_after.csv")
all.after.summary <- full_join(ad.af.col, s2.af.col, by = c("Nest", "Treatment"))
all.after.summary <- full_join(all.after.summary, s1.af.col, by = c("Nest", "Treatment"))
sub1.col <- full_join(s1.bf.col, s1.af.col)
sub1.col$diff.resids <- sub1.col$after.res - sub1.col$before.res
adults.col$instar <- "Adult"
sub2.col$instar <- "Sub 2"
sub1.col$instar <- "Sub 1"
all.col <- rbind(adults.col, sub2.col, sub1.col)
diff.mod <- lm(diff.resids ~ instar + Treatment+instar:Treatment, data = all.col)
sub1.col <- full_join(s1.bf.col, s1.af.col)
sub1.col$diff.resids <- sub1.col$after.res - sub1.col$before.res
setwd("/Users/sam/github/FitnessEffects/scripts")
######## ADULTS  ##########
# body condition
df_all <- read.csv("../data/eximius_body_measurements.csv")
levels(df_all$Measurement)
df_all$Measurement <- factor(df_all$Measurement, levels= c("before", "after"))
# remove Col_21 : Note says "Escapees"
df_all <- df_all %>% filter(Nest != "Col_21")
adults <- df_all %>% filter(instar == "Adult")
adults$weight.mg <- adults$weight.grams * 1000
y <- lm(log(weight.mg) ~ log(CT.W), data = adults)
adults$resids <- residuals(y)
# adults, before comparing treatments
adults.before <- adults %>%
filter(Measurement == "before")
# adults, after comparing treatments
adults.after <- adults %>%
filter(Measurement == "after")
# adults, control, comparing before and after
adults.control <- adults %>%
filter(Treatment == "Control")
# parasites, control, comparing before and after
adults.parasite <- adults %>%
filter(Treatment == "Parasite")
ad.bf.col <- adults.before %>%
group_by(Nest, Treatment) %>%
summarize(before.res = mean(resids))
ad.af.col <- adults.after %>%
group_by(Nest, Treatment) %>%
summarize(ad.after.res = mean(resids)) %>%
mutate(instar = "Adult")
adults.col <- full_join(ad.bf.col, ad.af.col)
adults.col$diff.resids <- adults.col$after.res - adults.col$before.res
View(adults.col)
adults.col$diff.resids <- adults.col$after.res - adults.col$before.res
ad.af.col <- adults.after %>%
group_by(Nest, Treatment) %>%
summarize(after.res = mean(resids)) %>%
mutate(instar = "Adult")
adults.col <- full_join(ad.bf.col, ad.af.col)
adults.col$diff.resids <- adults.col$after.res - adults.col$before.res
####### Sub 2 body condition ########
levels(df_all$instar)
#df_all <- read.csv("eximius_body_measurements.csv")
sub2 <- df_all %>% filter(instar == "Sub 2")
sub2$weight.mg <- sub2$weight.grams * 1000
y <- lm(log(weight.mg) ~ log(CT.W), data = sub2)
sub2$resids <- residuals(y)
#### sub 2 effect sizes ####
# sub2, before comparing treatments
sub2.before <- sub2 %>%
filter(Measurement == "before")
# sub2, after comparing treatments
sub2.after <- sub2 %>%
filter(Measurement == "after")
# sub2, control, comparing before and after
sub2.control <- sub2 %>%
filter(Treatment == "Control")
# parasites, sub2, comparing before and after
sub2.parasite <- sub2 %>%
filter(Treatment == "Parasite")
s2.bf.col <- sub2.before %>%
group_by(Nest, Treatment) %>%
summarize(before.res = mean(resids))
s2.af.col <- sub2.after %>%
group_by(Nest, Treatment) %>%
summarize(after.res = mean(resids)) %>%
mutate(instar = "Sub2")
sub2.col <- full_join(s2.bf.col, s2.af.col)
sub2.col$diff.resids <- sub2.col$after.res - sub2.col$before.res
sub1.final <- read.csv("../data/Sub1wts.csv")
# remove colony 21
sub1.final <- sub1.final %>% filter(Nest != "Col_21")
sub1.final$Measurement <- factor(sub1.final$Measurement, levels = c("before", "after"))
y <- lm(log(weight.mg) ~ log(CT.W), data = sub1.final)
sub1.final$resids <- residuals(y)
s1.bf.col <- sub1.before %>%
group_by(Nest, Treatment) %>%
summarize(before.res = mean(resids))
s1.af.col <- sub1.after %>%
group_by(Nest, Treatment) %>%
summarize(after.res = mean(resids)) %>%
mutate(instar = "Sub1")
sub1.col <- full_join(s1.bf.col, s1.af.col)
s1.bf.col <- sub1.before %>%
group_by(Nest, Treatment) %>%
summarize(before.res = mean(resids))
s1.af.col <- sub1.after %>%
group_by(Nest, Treatment) %>%
summarize(after.res = mean(resids)) %>%
mutate(instar = "Sub1")
sub1.col <- full_join(s1.bf.col, s1.af.col)
s1.bf.col <- sub1.before %>%
group_by(Nest, Treatment) %>%
summarize(before.res = mean(resids))
#### sub 1 effect sizes ####
# sub1, before comparing treatments
sub1.before <- sub1.final %>%
filter(Measurement == "before")
# sub1, after comparing treatments
sub1.after <- sub1.final %>%
filter(Measurement == "after")
s1.bf.col <- sub1.before %>%
group_by(Nest, Treatment) %>%
summarize(before.res = mean(resids))
s1.af.col <- sub1.after %>%
group_by(Nest, Treatment) %>%
summarize(after.res = mean(resids)) %>%
mutate(instar = "Sub1")
all.after.summary <- full_join(ad.af.col, s2.af.col, by = c("Nest", "Treatment"))
sub1.col <- full_join(s1.bf.col, s1.af.col)
sub1.col$diff.resids <- sub1.col$after.res - sub1.col$before.res
adults.col$instar <- "Adult"
sub2.col$instar <- "Sub 2"
sub1.col$instar <- "Sub 1"
all.col <- rbind(adults.col, sub2.col, sub1.col)
diff.plot <- ggplot(data = all.col, aes(x = instar, y = diff.resids, fill = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_fill_manual(values = c("black", "darkgrey"))+
# scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab(expression(paste(Delta~"BCI")))+
xlab("Instar")+
labs(fill = "Treatment")
############ Mortality ##########
col.counts <- read.csv("../data/colony_counts.csv")
# remove Col_21 : Note says "Escapees"
col.counts <- col.counts %>% filter(Colony != "Col_21")
write.csv(col.counts, "../data/colony_counts_CLEANED.csv")
View(col.counts)
col.counts$num.all <- col.counts$num.adult + col.counts$num.sub2 + col.counts$num.sub1
num.after <- col.counts[c(which(col.counts$Measurement == "After")),]
num.after[,7] <- NULL
mortality_plot <- ggplot(data = col.counts, aes(x = Treatment, y = num.all))+
geom_boxplot()+
ylab("Total number\n of spider remaining")+
theme(axis.text = element_text(size=20))+
theme_cowplot()
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto", widths = c(1, 0.75))
plot_5.2
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto", heights = c(1, 0.75))
ggsave(plot_5.2, filename = "../figures/Plot_5.2.jpeg", dpi = "retina", width = 5, height = 7, units = 'in')
l
mortality_plot <- ggplot(data = col.counts, aes(x = Treatment, y = num.all))+
geom_boxplot()+
ylab("Total number\n of spider remaining")+
theme(axis.text = element_text(size=20))+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
mortality_plot
mortality_plot <- ggplot(data = col.counts, aes(x = Treatment, y = num.all))+
geom_boxplot()+
ylab("Total number\n of spider remaining")+
theme(axis.text = element_text(size=20))+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))+
theme_cowplot()
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto",)
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto")
plot_5.2
mortality_plot
ggplot(data = col.counts, aes(x = Treatment, y = num.all))+
geom_boxplot()+
ylab("Total number\n of spider remaining")+
theme(axis.text = element_text(size=20))+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
theme_bw()
theme_bw()
mortality_plot <- ggplot(data = col.counts, aes(x = Treatment, y = num.all))+
geom_boxplot()+
ylab("Total number\n of spider remaining")+
theme(axis.text = element_text(size=20))+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
mortality_plot
mortality_plot <- ggplot(data = col.counts, aes(x = Treatment, y = num.all))+
geom_boxplot()+
ylab("Total number\n of spider remaining")+
theme(axis.text = element_text(size=20))+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))+
theme_bw()
mortality_plot
mortality_plot <- ggplot(data = col.counts, aes(x = Treatment, y = num.all))+
geom_boxplot()+
ylab("Total number\n of spider remaining")+
theme(axis.text = element_text(size=20))+
theme_cowplot()+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
mortality_plot
plot_5.2
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto")
plot_5.2
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto", common.legend = TRUE)
plot_5.2
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto", common.legend = TRUE, legend = "right")
plot_5.2
mortality_plot <- ggplot(data = col.counts, aes(x = Treatment, y = num.all, fill = Treatment))+
geom_boxplot()+
ylab("Total number\n of spider remaining")+
theme(axis.text = element_text(size=20))+
scale_fill_manual(values = c("black", "darkgrey"))+
theme_cowplot()+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto", common.legend = TRUE, legend = "right")
plot_5.2
mortality_plot <- ggplot(data = col.counts, aes(x = Treatment, y = num.all, fill = Treatment))+
geom_boxplot(alpha = 0.7)+
ylab("Total number\n of spider remaining")+
theme(axis.text = element_text(size=20))+
scale_fill_manual(values = c("black", "darkgrey"))+
theme_cowplot()+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
mortality_plot
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto", common.legend = TRUE, legend = "right")
ggsave(plot_5.2, filename = "../figures/Plot_5.2.jpeg", dpi = "retina", width = 5, height = 7, units = 'in')
mortality_plot <- ggplot(data = col.counts, aes(x = Treatment, y = num.all, fill = Treatment))+
geom_boxplot(alpha = 0.7)+
ylab("Total number\n of spider remaining")+
theme(text = element_text(size=20))+
scale_fill_manual(values = c("black", "darkgrey"))+
theme_cowplot()+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto", common.legend = TRUE, legend = "right")
ggsave(plot_5.2, filename = "../figures/Plot_5.2.jpeg", dpi = "retina", width = 5, height = 7, units = 'in')
all.col$instar <- factor(all.col$instar, order = TRUE, levels = c("Sub 1", "Sub 2", "Adult"))
diff.plot <- ggplot(data = all.col, aes(x = instar, y = diff.resids, fill = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_fill_manual(values = c("black", "darkgrey"))+
# scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab(expression(paste(Delta~"BCI")))+
xlab("Instar")+
labs(fill = "Treatment")
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto", common.legend = TRUE, legend = "right")
ggsave(plot_5.2, filename = "../figures/Plot_5.2.jpeg", dpi = "retina", width = 5, height = 7, units = 'in')
############ Mortality ##########
col.counts <- read.csv("../data/colony_counts.csv")
# remove Col_21 : Note says "Escapees"
col.counts <- col.counts %>% filter(Colony != "Col_21")
write.csv(col.counts, "../data/colony_counts_CLEANED.csv")
View(col.counts)
col.counts$num.all <- col.counts$num.adult + col.counts$num.sub2 + col.counts$num.sub1
num.after <- col.counts[c(which(col.counts$Measurement == "After")),]
num.after[,7] <- NULL
x <- lmer(num.all ~ Treatment + Measurement + Treatment*Measurement + (1|Colony), data = col.counts)
####### Load Libraries #########
library(car)
library(effsize)
library(lme4)
library(cowplot)
library(ggplot2)
library(stats) #glms
library(ggthemes)
library(scales)
library(tidyr)
library(dplyr)
library(ggpubr)
setwd("/Users/sam/github/FitnessEffects/scripts")
############ Mortality ##########
col.counts <- read.csv("../data/colony_counts.csv")
# remove Col_21 : Note says "Escapees"
col.counts <- col.counts %>% filter(Colony != "Col_21")
col.counts$num.all <- col.counts$num.adult + col.counts$num.sub2 + col.counts$num.sub1
num.after <- col.counts[c(which(col.counts$Measurement == "After")),]
num.after[,7] <- NULL
View(col.counts)
x <- lmer(num.all ~ Treatment + Measurement + Treatment*Measurement + (1|Colony), data = col.counts)
summary(x)
anova(x)
Anova(x)
View(num.after)
y <- lm(num.all ~ Measurement, data = col.counts)
anova(y)
y <- lm(num.all ~ Treatment, data = col.counts)
anova(y)
y <- glm(num.all ~ Treatment, data = col.counts, family = poisson(link = "identity"))
anova(y)
Anova(y)
Anova(y, test.statistic = "F")
?glm
x <- glmer(num.all ~ Treatment + Measurement + Treatment*Measurement + (1|Colony), family = poisson(link = "identity"), data = col.counts)
summary(x)
Anova(x)
Anova(x)
mortality_plot <- ggplot(data = col.counts, aes(x = Treatment, y = num.all, fill = Measurement))+
geom_boxplot(alpha = 0.7)+
ylab("Total number\n of spider remaining")+
theme(text = element_text(size=20))+
scale_fill_manual(values = c("black", "darkgrey"))+
theme_cowplot()+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
mortality_plot
mortality_plot <- ggplot(data = num.after, aes(x = Treatment, y = num.all, fill = Treatment))+
geom_boxplot(alpha = 0.7)+
ylab("Total number\n of spider remaining")+
theme(text = element_text(size=20))+
scale_fill_manual(values = c("black", "darkgrey"))+
theme_cowplot()+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
mortality_plot <- ggplot(data = num.after, aes(x = Treatment, y = num.all))+
geom_boxplot(alpha = 0.7)+
ylab("Total number\n of spider remaining")+
theme(text = element_text(size=20))+
scale_fill_manual(values = c("black", "darkgrey"))+
theme_cowplot()+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
mortality_plot
mortality_plot <- ggplot(data = num.after, aes(x = Treatment, y = num.all, fill = Treatment))+
geom_boxplot(alpha = 0.7)+
ylab("Total number\n of spider remaining")+
theme(text = element_text(size=20))+
scale_fill_manual(values = c("black", "darkgrey"))+
theme_cowplot()+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
mortality_plot
######## ADULTS  ##########
# body condition
df_all <- read.csv("../data/eximius_body_measurements.csv")
levels(df_all$Measurement)
df_all$Measurement <- factor(df_all$Measurement, levels= c("before", "after"))
# remove Col_21 : Note says "Escapees"
df_all <- df_all %>% filter(Nest != "Col_21")
adults <- df_all %>% filter(instar == "Adult")
adults$weight.mg <- adults$weight.grams * 1000
y <- lm(log(weight.mg) ~ log(CT.W), data = adults)
adults$resids <- residuals(y)
# adults, before comparing treatments
adults.before <- adults %>%
filter(Measurement == "before")
# adults, after comparing treatments
adults.after <- adults %>%
filter(Measurement == "after")
# parasites, control, comparing before and after
adults.parasite <- adults %>%
filter(Treatment == "Parasite")
ad.bf.col <- adults.before %>%
group_by(Nest, Treatment) %>%
summarize(before.res = mean(resids))
ad.af.col <- adults.after %>%
group_by(Nest, Treatment) %>%
summarize(after.res = mean(resids)) %>%
mutate(instar = "Adult")
adults.col <- full_join(ad.bf.col, ad.af.col)
adults.col$diff.resids <- adults.col$after.res - adults.col$before.res
####### Sub 2 body condition ########
levels(df_all$instar)
#df_all <- read.csv("eximius_body_measurements.csv")
sub2 <- df_all %>% filter(instar == "Sub 2")
sub2$weight.mg <- sub2$weight.grams * 1000
y <- lm(log(weight.mg) ~ log(CT.W), data = sub2)
sub2$resids <- residuals(y)
#### sub 2 effect sizes ####
# sub2, before comparing treatments
sub2.before <- sub2 %>%
filter(Measurement == "before")
# sub2, after comparing treatments
sub2.after <- sub2 %>%
filter(Measurement == "after")
s2.bf.col <- sub2.before %>%
group_by(Nest, Treatment) %>%
summarize(before.res = mean(resids))
s2.af.col <- sub2.after %>%
group_by(Nest, Treatment) %>%
summarize(after.res = mean(resids)) %>%
mutate(instar = "Sub2")
sub2.col <- full_join(s2.bf.col, s2.af.col)
sub2.col$diff.resids <- sub2.col$after.res - sub2.col$before.res
sub1.final <- read.csv("../data/Sub1wts.csv")
# remove colony 21
sub1.final <- sub1.final %>% filter(Nest != "Col_21")
sub1.final$Measurement <- factor(sub1.final$Measurement, levels = c("before", "after"))
y <- lm(log(weight.mg) ~ log(CT.W), data = sub1.final)
sub1.final$resids <- residuals(y)
#### sub 1 effect sizes ####
# sub1, before comparing treatments
sub1.before <- sub1.final %>%
filter(Measurement == "before")
# sub1, after comparing treatments
sub1.after <- sub1.final %>%
filter(Measurement == "after")
s1.bf.col <- sub1.before %>%
group_by(Nest, Treatment) %>%
summarize(before.res = mean(resids))
s1.af.col <- sub1.after %>%
group_by(Nest, Treatment) %>%
summarize(after.res = mean(resids))
all.after.summary <- full_join(ad.af.col, s2.af.col, by = c("Nest", "Treatment"))
all.after.summary <- full_join(all.after.summary, s1.af.col, by = c("Nest", "Treatment"))
sub1.col <- full_join(s1.bf.col, s1.af.col)
sub1.col$diff.resids <- sub1.col$after.res - sub1.col$before.res
adults.col$instar <- "Adult"
sub2.col$instar <- "Sub 2"
sub1.col$instar <- "Sub 1"
all.col <- rbind(adults.col, sub2.col, sub1.col)
diff.mod.emm <- emmeans(diff.mod, "instar", data = all.col)
diff.mod <- lm(diff.resids ~ instar + Treatment+instar:Treatment, data = all.col)
diff.plot <- ggplot(data = all.col, aes(x = instar, y = diff.resids, fill = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_fill_manual(values = c("black", "darkgrey"))+
# scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab(expression(paste(Delta~"BCI")))+
xlab("Instar")+
labs(fill = "Treatment")
_
plot_5.2
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto", common.legend = TRUE, legend = "right")
plot_5.2
all.col$instar <- factor(all.col$instar, order = TRUE, levels = c("Sub 1", "Sub 2", "Adult"))
diff.plot <- ggplot(data = all.col, aes(x = instar, y = diff.resids, fill = Treatment,                          fill = instar))+
geom_boxplot(alpha = 0.7)+
# geom_jitter(aes(group = Treatment))+
geom_hline(yintercept = 0, color = 'red')+
theme_classic()+
scale_fill_manual(values = c("black", "darkgrey"))+
# scale_fill_manual(values = c(paste(my_pal[2:4])))+
theme(text = element_text(size=20))+
ylab(expression(paste(Delta~"BCI")))+
xlab("Instar")+
labs(fill = "Treatment")
diff.plot
mortality_plot <- ggplot(data = num.after, aes(x = Treatment, y = num.all, fill = Treatment))+
geom_boxplot(alpha = 0.7)+
ylab("Total number\n of spider remaining")+
theme(text = element_text(size=20))+
scale_fill_manual(values = c("black", "darkgrey"))+
theme_cowplot()+
theme(plot.margin = margin(1,1,1.5,1.2, "cm"))
mortality_plot
plot_5.2 <- ggarrange(diff.plot, mortality_plot, nrow = 2, labels = "auto", common.legend = TRUE, legend = "right")
ggsave(plot_5.2, filename = "../figures/Plot_5.2.jpeg", dpi = "retina", width = 5, height = 7, units = 'in')
